package templates

import (
"github.com/sentientbottleofwine/osmium/teamserver"
"strconv"
)

templ AgentsView(agents []teamserver.AgentView) {
<div id="Agents" class="basis-[50svw] dashboard-element flex flex-col min-h-0">
    <div id="agent-dummy" hx-ext="sse" sse-connect="/api/agents/register/listen" sse-swap="agent" hx-swap="none"></div>
    <h2 class="dashboard-element-header">Agents</h2>
    <div id="agent-table-head" class="flex flex-row justify-between ml-1">
        <h4 class="text-indigo-600 font-medium">Agent Id</h4>
    </div>
    // Not a table because css is a joke
    <div id="agent-table-body" class="overflow-auto min-h-0 rounded-md m-1 border-2 border-zinc-500">
        for i, agent := range agents {
        if i % 2 == 0 {
        <div class="agent flex flex-row justify-between p-1 bg-neutral-950/90">
            @agentView(agent.AgentId)
        </div>
        } else {
        <div class="agent flex flex-row justify-between p-1 bg-neutral-900">
            @agentView(agent.AgentId)
        </div>
        }
        }
    </div>
</div>
}

templ agentView(agentId uint64) {
<p>{ strconv.FormatUint(agentId, 10) }</p>
<button class="agent-reveal-on-hover bg-zinc-300/30 px-2 mr-1 rounded-md" onclick={ templ.JSFuncCall("termInit",
    agentId) }>
    Choose agent
</button>
}

templ AgentOOB(agent *teamserver.Agent) {
<div hx-swap-oob="beforeend:#agent-table-body">
    <div class="agent flex flex-row justify-between">
        <p>{ strconv.FormatUint(agent.AgentId, 10) }</p>
        <button class="agent-reveal-on-hover" onclick={ templ.JSFuncCall("termInit", agent.AgentId) }>
            Choose agent
        </button>
    </div>
</div>
}
